# Changelog

所有重要的项目变更都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划中的功能
- 支持渐变填充
- 支持分段进度条（不同颜色显示不同进度段）
- 支持动画效果（如脉冲、闪烁等）
- 支持自定义进度条形状（不仅仅是圆角矩形）
- 支持进度条方向反转
- 支持自定义动画缓动函数

## [0.2.0] - 2025-11-30

### Added
- 动态计算 `MIN_SIZE`：根据圆角半径和高度自动计算最小尺寸，防止圆角矩形在宽度过小时发生挤压变形
- 优化填充条更新机制：使用 `become` 方法直接替换填充条，提升性能并避免视觉闪烁
- 更改默认字体：百分比文本默认字体从 "Arial" 改为 "Sans"（Manim 常用默认无衬线字体，兼容性更好）
- 完善的测试用例：在 `progress_bar_example.py` 中添加了 10 个全面的测试场景，包括边界测试、角度测试、自定义样式测试等

### Changed
- 代码架构优化：移除了不必要的投影计算，简化了 `bg_half_length` 的计算逻辑，直接使用原始宽高
- 方向向量计算优化：添加了 `_get_direction_vector` 辅助方法，对特殊角度（0°、90°、180°、270°）使用精确值，避免浮点误差
- 填充条创建逻辑：在 `_create_fill_bar` 中明确设置所有颜色和描边属性，确保颜色饱满且无描边

### Fixed
- **修复90度角时的浮点误差问题**：在计算方向向量时，对特殊角度使用精确值（如 90° 使用 `[0, 1, 0]`），避免了浮点数计算误差导致的填充条位置不准确
- **修复百分比文本在100%时不隐藏的问题**：统一了 `set_progress`、`update_progress_instant` 和 `auto_progress` 中的百分比文本隐藏逻辑，使用 `UpdateFromAlphaFunc` 在动画过程中逐渐隐藏文本，确保在有角度时也能正常工作
- **修复颜色变淡问题**：在填充条创建和更新的所有阶段都强制设置颜色和不透明度为 1.0，防止动画过程中颜色被混合或变淡
- **修复白色框（描边）问题**：在所有设置描边的地方都明确设置 `stroke_width=0` 和 `stroke_opacity=0`，确保填充条没有白色描边框
- **修复 auto_progress 完成后进度条归零的问题**：在清理 updater 之前，确保进度条已更新到最终状态，避免状态丢失
- **修复 get_opacity() 返回 None 导致的 TypeError**：添加了 None 检查，防止在检查百分比文本透明度时出现类型错误

### Technical Details
- 优化了 `_update_fill_bar` 方法，使用 `become` 替代 `remove`/`add`，减少对象创建和销毁开销
- 在所有颜色设置操作后都强制刷新属性，确保 Manim 渲染管道正确应用颜色
- 改进了百分比文本的显示/隐藏逻辑，使用统一的文本替换机制

## [0.1.1] - 2025-11-30

### Added
- 无

### Features
- 无


## [0.1.0] - 2025-11-30

### Added
- 初始版本发布
- 基础进度条功能
- 支持自定义样式（颜色、大小、位置等）
- 支持自动进度推进
- 支持手动设置进度
- 支持百分比显示

### Features
- `set_progress()` - 手动设置进度
- `auto_progress()` - 根据时间自动推进
- `start()` - 使用预设时长自动推进
- `update_progress_instant()` - 立即更新进度（无动画）


